#!/usr/bin/python
# create an umbrella for 3 subtrees

from MDSplus import *

import sys

if len(sys.argv) != 2:
	sys.exit("usage make-acq196-supertree NNN")

NNN=sys.argv[1]

SUPERT = 'acq196_'+ NNN
SUBTREE = 'a'+ NNN + '_'

def makeTags(stree, field, ch1, nch):
    tree = Tree(stree, -1, "edit")
    for ch in range(ch1, ch1+nch):
        tag = 'CH%02d' % ch
        leaf = '%s.CH%02d' % (field, ch - ch1 + 1)
        print "%s:%s -> \\%s" % (stree, leaf, tag)
        try:
            tree.getNode(leaf).addTag(tag)
        except Exception as detail:
            print "exception:", detail
    tree.write()

for st in [1,2,3]:
    stree = '%s%d' % (SUBTREE, st)
    blk = st - 1
    field = 'AI%02d%02d' % (blk*32+1, blk*32+32)
    print "stree %s field %s" % (stree, field)

    makeTags(stree, field, blk*32+1, 32)
